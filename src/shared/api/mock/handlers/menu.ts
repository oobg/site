import { Server, Request } from 'miragejs';

// ë©”ë‰´ë³„ ì´ëª¨ì§€ ë§¤í•‘
const menuIconMap: Record<string, string> = {
  // í•œì‹
  ê¹€ì¹˜ì°Œê°œ: 'ğŸ²',
  ëœì¥ì°Œê°œ: 'ğŸ²',
  ë¹„ë¹”ë°¥: 'ğŸš',
  ë¶ˆê³ ê¸°: 'ğŸ¥©',
  ì‚¼ê²¹ì‚´: 'ğŸ¥“',
  ê°ˆë¹„íƒ•: 'ğŸ²',
  ì„¤ë íƒ•: 'ğŸ²',
  ìˆœë‘ë¶€ì°Œê°œ: 'ğŸ²',
  ì œìœ¡ë³¶ìŒ: 'ğŸ¥©',
  ë‹­ë³¶ìŒíƒ•: 'ğŸ—',
  ì¶”ì–´íƒ•: 'ğŸ²',
  í•´ë¬¼íŒŒì „: 'ğŸ«“',
  ëƒ‰ë©´: 'ğŸœ',
  ìœ¡ê°œì¥: 'ğŸ²',
  ë³´ìŒˆ: 'ğŸ¥¬',
  // ì¼ì‹
  ë¼ë©˜: 'ğŸœ',
  ëˆê¹ŒìŠ¤: 'ğŸ›',
  ì´ˆë°¥: 'ğŸ£',
  ìš°ë™: 'ğŸœ',
  ì¹´ë ˆ: 'ğŸ›',
  ì˜¤ë¯€ë¼ì´ìŠ¤: 'ğŸ›',
  ê·œë™: 'ğŸ›',
  ê°€ì¸ ë™: 'ğŸ›',
  ì˜¤ì•¼ì½”ë™: 'ğŸ›',
  íƒ€ì½”ì•¼í‚¤: 'ğŸ™',
  ì˜¤ì½”ë…¸ë¯¸ì•¼í‚¤: 'ğŸ¥',
  ì‚¬ì‹œë¯¸: 'ğŸ£',
  í…ë™: 'ğŸ¤',
  ë‚˜ë² : 'ğŸ²',
  ì•¼í‚¤ë‹ˆì¿ : 'ğŸ¥©',
  // ì–‘ì‹
  íŒŒìŠ¤íƒ€: 'ğŸ',
  í”¼ì: 'ğŸ•',
  ìŠ¤í…Œì´í¬: 'ğŸ¥©',
  í–„ë²„ê±°: 'ğŸ”',
  ìƒëŸ¬ë“œ: 'ğŸ¥—',
  ë¦¬ì¡°ë˜: 'ğŸš',
  ìƒŒë“œìœ„ì¹˜: 'ğŸ¥ª',
  ì¹˜í‚¨: 'ğŸ—',
  ê·¸ë¼íƒ•: 'ğŸ²',
  ë¼ìëƒ: 'ğŸ',
  ë‡¨ë¼: 'ğŸ¥Ÿ',
  í¬ë¦¼ìŠ¤í”„: 'ğŸ²',
  ì¹˜ì¦ˆë²„ê±°: 'ğŸ”',
  í”¼ì‰¬ì•¤ì¹©ìŠ¤: 'ğŸŸ',
  íŒ¬ì¼€ì´í¬: 'ğŸ¥',
  // ì¤‘ì‹
  ì§œì¥ë©´: 'ğŸœ',
  ì§¬ë½•: 'ğŸœ',
  íƒ•ìˆ˜ìœ¡: 'ğŸ–',
  ì–‘ì¥í”¼: 'ğŸ¥—',
  ë§ˆíŒŒë‘ë¶€: 'ğŸ²',
  ê¹í’ê¸°: 'ğŸ—',
  ìœ ì‚°ìŠ¬: 'ğŸ¥©',
  ê³ ì¶”ì¡ì±„: 'ğŸ¥©',
  ë³¶ìŒë°¥: 'ğŸš',
  ì–‘ê¼¬ì¹˜: 'ğŸ¢',
  ë§ˆë¼íƒ•: 'ğŸ²',
  í› ê¶ˆ: 'ğŸ²',
  ìƒ¤ì˜¤ë¡±ë°”ì˜¤: 'ğŸ¥Ÿ',
  ë”¤ì„¬: 'ğŸ¥Ÿ',
  íŒ”ë³´ì±„: 'ğŸ¥—',
};

// ì¹´í…Œê³ ë¦¬ë³„ ë©”ë‰´ ëª©ë¡
const menuData: Record<string, string[]> = {
  korean: [
    'ê¹€ì¹˜ì°Œê°œ',
    'ëœì¥ì°Œê°œ',
    'ë¹„ë¹”ë°¥',
    'ë¶ˆê³ ê¸°',
    'ì‚¼ê²¹ì‚´',
    'ê°ˆë¹„íƒ•',
    'ì„¤ë íƒ•',
    'ìˆœë‘ë¶€ì°Œê°œ',
    'ì œìœ¡ë³¶ìŒ',
    'ë‹­ë³¶ìŒíƒ•',
    'ì¶”ì–´íƒ•',
    'í•´ë¬¼íŒŒì „',
    'ëƒ‰ë©´',
    'ìœ¡ê°œì¥',
    'ë³´ìŒˆ',
  ],
  japanese: [
    'ë¼ë©˜',
    'ëˆê¹ŒìŠ¤',
    'ì´ˆë°¥',
    'ìš°ë™',
    'ì¹´ë ˆ',
    'ì˜¤ë¯€ë¼ì´ìŠ¤',
    'ê·œë™',
    'ê°€ì¸ ë™',
    'ì˜¤ì•¼ì½”ë™',
    'íƒ€ì½”ì•¼í‚¤',
    'ì˜¤ì½”ë…¸ë¯¸ì•¼í‚¤',
    'ì‚¬ì‹œë¯¸',
    'í…ë™',
    'ë‚˜ë² ',
    'ì•¼í‚¤ë‹ˆì¿ ',
  ],
  western: [
    'íŒŒìŠ¤íƒ€',
    'í”¼ì',
    'ìŠ¤í…Œì´í¬',
    'í–„ë²„ê±°',
    'ìƒëŸ¬ë“œ',
    'ë¦¬ì¡°ë˜',
    'ìƒŒë“œìœ„ì¹˜',
    'ì¹˜í‚¨',
    'ê·¸ë¼íƒ•',
    'ë¼ìëƒ',
    'ë‡¨ë¼',
    'í¬ë¦¼ìŠ¤í”„',
    'ì¹˜ì¦ˆë²„ê±°',
    'í”¼ì‰¬ì•¤ì¹©ìŠ¤',
    'íŒ¬ì¼€ì´í¬',
  ],
  chinese: [
    'ì§œì¥ë©´',
    'ì§¬ë½•',
    'íƒ•ìˆ˜ìœ¡',
    'ì–‘ì¥í”¼',
    'ë§ˆíŒŒë‘ë¶€',
    'ê¹í’ê¸°',
    'ìœ ì‚°ìŠ¬',
    'ê³ ì¶”ì¡ì±„',
    'ë³¶ìŒë°¥',
    'ì–‘ê¼¬ì¹˜',
    'ë§ˆë¼íƒ•',
    'í› ê¶ˆ',
    'ìƒ¤ì˜¤ë¡±ë°”ì˜¤',
    'ë”¤ì„¬',
    'íŒ”ë³´ì±„',
  ],
};

export const menuHandlers = (server: Server) => {
  // GET /api/menu/recommend?category={category}
  server.get('/menu/recommend', (_schema: unknown, request: Request) => {
    const categoryParam = request.queryParams.category;
    const category = Array.isArray(categoryParam) ? categoryParam[0] : categoryParam;

    if (!category) {
      return new Response(JSON.stringify({ error: 'Category parameter is required' }), {
        status: 400,
        headers: { 'Content-Type': 'application/json' },
      });
    }

    const menus = menuData[category];
    if (!menus || menus.length === 0) {
      return new Response(JSON.stringify({ error: 'Invalid category' }), {
        status: 400,
        headers: { 'Content-Type': 'application/json' },
      });
    }

    // ëœë¤ìœ¼ë¡œ ë©”ë‰´ ì„ íƒ
    const randomMenu = menus[Math.floor(Math.random() * menus.length)];

    // ì¹´í…Œê³ ë¦¬ í•œê¸€ëª… ë§¤í•‘
    const categoryMap: Record<string, string> = {
      korean: 'í•œì‹',
      japanese: 'ì¼ì‹',
      western: 'ì–‘ì‹',
      chinese: 'ì¤‘ì‹',
    };

    // ë©”ë‰´ì— í•´ë‹¹í•˜ëŠ” ì´ëª¨ì§€ ê°€ì ¸ì˜¤ê¸° (ì—†ìœ¼ë©´ ë¹ˆ ë¬¸ìì—´)
    const menuIcon = menuIconMap[randomMenu] || '';

    return {
      category: categoryMap[category] || category,
      menu: randomMenu,
      icon: menuIcon,
    };
  });
};
